window.__require=function e(t,o,r){function i(s,c){if(!o[s]){if(!t[s]){var l=s.split("/");if(l=l[l.length-1],!t[l]){var a="function"==typeof __require&&__require;if(!c&&a)return a(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){return i(t[s][1][e]||e)},u,u.exports,e,t,o,r)}return o[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<r.length;s++)i(r[s]);return i}({BaseTile:[function(e,t,o){"use strict";cc._RF.push(t,"5abb5RWStlIxIpaj0GYQmnu","BaseTile"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseTile=void 0;o.BaseTile=function(e){this.id=e},cc._RF.pop()},{}],BoardController:[function(e,t,o){"use strict";cc._RF.push(t,"1bb93UG4DpIrYGdtZwQVEQs","BoardController");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(i,n){function s(e){try{l(r.next(e))}catch(t){n(t)}}function c(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(e){return function(t){return l([e,t])}}function l(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(c){n=[6,c],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BoardController=void 0;var n=e("../models/CellPos"),s=e("../../utils/Utils"),c=e("../models/NormalTile"),l=function(){function e(e,t,o,r,i,n,s,c,l,a){this.rows=e,this.cols=t,this.spawnTiles=o,this.tileFactory=r,this.superTileRules=i,this.boardView=n,this.framesById=s,this.startMoves=c,this.targetScore=l,this.isBusy=!1,this.isGameOver=!1,this.progress=a}return e.prototype.start=function(){this.isGameOver=!1,this.progress.init(this.startMoves,this.targetScore),this.generate(),this.hasAnyMove()?this.boardView.onCellClick=null:this.endGame(!1)},e.prototype.isBusyOrOver=function(){return this.isBusy||this.isGameOver},e.prototype.handleBoardClick=function(e){return r(this,void 0,Promise,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.tryCollectTiles(e)];case 1:return t.sent(),[2]}})})},e.prototype.setSelection=function(e,t){this.boardView.setSelected(e,t)},e.prototype.stop=function(){},e.prototype.generate=function(){this.tiles=[],this.boardView.init(this.rows,this.cols);for(var e=0;e<this.rows;e++){for(var t=[],o=0;o<this.cols;o++){var r=this.randomId();t.push(this.tileFactory.createTile(r)),this.boardView.setFrameTile({r:e,c:o},this.framesById.get(r))}this.tiles.push(t)}},e.prototype.randomId=function(){var e=Math.floor(Math.random()*this.spawnTiles.length);return this.spawnTiles[e]},e.prototype.activeteOtherSuperTiles=function(e,t){var o=this;this.uniqSuperTiles.add(t),e.forEach(function(e){o.uniqTiles.add(e),o.tiles[e.r][e.c]instanceof c.NormalTile||o.uniqSuperTiles.has(e)||o.activeteOtherSuperTiles(o.tiles[e.r][e.c].getAffected(o.tiles,e),e)})},e.prototype.tryCollectTiles=function(e){return r(this,void 0,void 0,function(){var t,o,r,l,a,u,p=this;return i(this,function(i){switch(i.label){case 0:return this.isBusy||this.isGameOver?[2]:(t=this.tiles[e.r][e.c],o=t.getAffected(this.tiles,e),(r=t instanceof c.NormalTile)&&o.length<this.superTileRules.minGroupToDestroy?[2]:this.progress.canSpendMove()?(this.progress.spendMove(),this.isBusy=!0,l=null,r?l=this.superTileRules.pickSpawnId(o.length):(this.uniqSuperTiles=new n.UniqueCellPosSet(this.cols),this.uniqTiles=new n.UniqueCellPosSet(this.cols),this.activeteOtherSuperTiles(o,e),o=this.uniqTiles.toArray()),[4,this.boardView.hideTilesAnimated(o)]):(this.endGame(!1),[2]));case 1:return i.sent(),this.addScore(o.length),o.forEach(function(e){p.tiles[e.r][e.c]=null}),l&&(this.tiles[e.r][e.c]=this.tileFactory.createTile(l),this.boardView.createTileInPlace(e,this.framesById.get(l))),a=this.moveTileDown(),[4,this.boardView.moveTilesAnimated(a)];case 2:return i.sent(),u=this.addNewTiles(),this.boardView.renderTilesAnimated(u),[4,s.delay(80)];case 3:return i.sent(),this.checkEndConditions()?(this.isBusy=!1,[2]):this.hasAnyMove()?(this.isBusy=!1,[2]):(this.endGame(!1),this.isBusy=!1,[2])}})})},e.prototype.getTileId=function(e){var t,o=null===(t=this.tiles[e.r])||void 0===t?void 0:t[e.c];return o?o.id:null},e.prototype.swapTiles=function(e,t){var o,n;return r(this,void 0,Promise,function(){var r,s;return i(this,function(i){switch(i.label){case 0:return this.isBusy||this.isGameOver?[2]:(r=null===(o=this.tiles[e.r])||void 0===o?void 0:o[e.c],s=null===(n=this.tiles[t.r])||void 0===n?void 0:n[t.c],r&&s?(this.isBusy=!0,this.tiles[e.r][e.c]=s,this.tiles[t.r][t.c]=r,[4,this.boardView.swapTilesAnimated(e,t)]):[2]);case 1:return i.sent(),this.isBusy=!1,[2]}})})},e.prototype.activateSuperAt=function(e,t){return r(this,void 0,Promise,function(){var o,r,n,c,l=this;return i(this,function(i){switch(i.label){case 0:return this.isBusy||this.isGameOver?[2]:(this.isBusy=!0,o=this.tileFactory.createTile(t),this.tiles[e.r][e.c]=o,this.boardView.createTileInPlace(e,this.framesById.get(t)),0===(r=o.getAffected(this.tiles,e)).length?(this.isBusy=!1,[2]):[4,this.boardView.hideTilesAnimated(r)]);case 1:return i.sent(),this.addScore(r.length),r.forEach(function(e){l.tiles[e.r][e.c]=null}),n=this.moveTileDown(),[4,this.boardView.moveTilesAnimated(n)];case 2:return i.sent(),c=this.addNewTiles(),this.boardView.renderTilesAnimated(c),[4,s.delay(80)];case 3:return i.sent(),this.checkEndConditions()?(this.isBusy=!1,[2]):this.hasAnyMove()?(this.isBusy=!1,[2]):(this.endGame(!1),this.isBusy=!1,[2])}})})},e.prototype.addNewTiles=function(){for(var e=[],t=0;t<this.tiles.length;t++)for(var o=0;o<this.tiles.length;o++)if(!this.tiles[t][o]){var r=this.randomId();this.tiles[t][o]=this.tileFactory.createTile(r),e.push({r:t,c:o}),this.boardView.createTile({r:t,c:o},this.framesById.get(r))}return e},e.prototype.moveTileDown=function(){var e=[];if(this.tiles.length<2)return e;for(var t=0;t<this.cols;t++)for(var o=0,r=0;r<this.rows;r++){var i=this.tiles[r][t];i&&(r!==o&&(e.push({from:{r:r,c:t},to:{r:o,c:t}}),this.tiles[o][t]=i,this.tiles[r][t]=null),o++)}return e},e.prototype.addScore=function(e){var t=10*e;this.progress.addScore(t)},e.prototype.checkEndConditions=function(){return this.progress.isWin()?(this.endGame(!0),!0):this.progress.getMoves()<=0&&(this.endGame(!1),!0)},e.prototype.endGame=function(e){this.isGameOver=!0,this.boardView.onCellClick=null,this.progress.showResult(e?"\u041f\u043e\u0431\u0435\u0434\u0430":"\u041f\u043e\u0440\u0430\u0436\u0435\u043d\u0438\u0435")},e.prototype.hasAnyMove=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.cols;t++)if((r=this.tiles[e][t])&&!(r instanceof c.NormalTile))return!0;var o=new Array(this.rows);for(e=0;e<this.rows;e++)o[e]=new Array(this.cols).fill(!1);for(e=0;e<this.rows;e++)for(t=0;t<this.cols;t++){var r;if(!o[e][t]&&(r=this.tiles[e][t])&&r instanceof c.NormalTile&&this.countGroupSize(e,t,r.id,o)>=this.superTileRules.minGroupToDestroy)return!0}return!1},e.prototype.countGroupSize=function(e,t,o,r){for(var i=0,n=[{r:e,c:t}];n.length>0;){var s=n.pop();if(!r[s.r][s.c]){r[s.r][s.c]=!0;var l=this.tiles[s.r][s.c];l&&l instanceof c.NormalTile&&l.id===o&&(i++,s.r>0&&n.push({r:s.r-1,c:s.c}),s.r+1<this.rows&&n.push({r:s.r+1,c:s.c}),s.c>0&&n.push({r:s.r,c:s.c-1}),s.c+1<this.cols&&n.push({r:s.r,c:s.c+1}))}}return i},e}();o.BoardController=l,cc._RF.pop()},{"../../utils/Utils":"Utils","../models/CellPos":"CellPos","../models/NormalTile":"NormalTile"}],BoardModel:[function(e,t){"use strict";cc._RF.push(t,"7510bBjUsFPraUXwss//y7/","BoardModel"),cc._RF.pop()},{}],BoardView:[function(e,t,o){"use strict";cc._RF.push(t,"16313bBuPpAb41XgyNZwsJK","BoardView");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoardView=void 0;var s=e("./TileView"),c=cc._decorator,l=c.ccclass,a=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCellClick=null,t.spawnFallDuration=.25,t.spawnFadeDuration=.25,t.moveDuration=.2,t.tilesRoot=null,t.tilesViewRoot=null,t.tilePrefab=null,t.cellPrefab=null,t.syncScheduled=!1,t}return i(t,e),t.prototype.init=function(e,t){this.tileViews=new Array(e);for(var o=0;o<this.tileViews.length;o++)this.tileViews[o]=new Array(t);this.tilesRoot.removeAllChildren(),this.tilesViewRoot&&this.tilesViewRoot.removeAllChildren(),this.syncScheduled=!1;for(var r=0;r<e;r++)for(var i=0;i<t;i++){var n=cc.instantiate(this.cellPrefab);n.parent=this.tilesRoot;var c=cc.instantiate(this.tilePrefab);c.parent=this.tilesViewRoot?this.tilesViewRoot:this.node,c.width=n.width,c.height=n.height;var l=c.getComponent(s.TileView);this.bindClick(l,{r:r,c:i}),this.tileViews[r][i]={view:l,pos:n}}this.syncNow(),this.requestSyncPositions()},t.prototype.createTile=function(e,t){this.setFrameTile(e,t),this.renderTileAnimated(e)},t.prototype.createTileInPlace=function(e,t){this.setFrameTile(e,t),this.renderTileAnimatedInPlace(e)},t.prototype.setFrameTile=function(e,t){var o=this.tileViews[e.r][e.c];o&&(o.view.setFrame(t),o.view.node.active=!0,o.view.node.opacity=255,o.view.node.scale=1,this.setPosition(e))},t.prototype.renderTileAnimated=function(e){var t=this,o=this.tileViews[e.r][e.c];if(!o)return Promise.resolve();var r=this.getCellLocalPos(e),i=cc.v2(r.x,r.y+2*o.pos.height);return new Promise(function(e){var n=o.view.node;n.stopAllActions(),n.active=!0,n.opacity=0,n.setPosition(i);var s=cc.moveTo(t.spawnFallDuration,r),c=cc.fadeTo(t.spawnFadeDuration,255),l=cc.spawn(s,c),a=cc.sequence(l,cc.callFunc(function(){return e()}));n.runAction(a)})},t.prototype.renderTileAnimatedInPlace=function(e){var t=this.tileViews[e.r][e.c];if(!t)return Promise.resolve();var o=t.view.node;return o.stopAllActions(),o.active=!0,o.opacity=255,this.setPosition(e),new Promise(function(e){t.view.playSpawn(e)})},t.prototype.renderTilesAnimated=function(e){var t=this;return Promise.all(e.map(function(e){return t.renderTileAnimated(e)})).then(function(){})},t.prototype.hideTileAnimated=function(e){var t=this.tileViews[e.r][e.c];return t?new Promise(function(e){t.view.playHide(e)}):Promise.resolve()},t.prototype.hideTilesAnimated=function(e){var t=this;return Promise.all(e.map(function(e){return t.hideTileAnimated(e)})).then(function(){})},t.prototype.setSelected=function(e,t){var o=this.tileViews[e.r][e.c];o&&(o.view.node.scale=t?1.15:1)},t.prototype.moveTilesAnimated=function(e,t){var o=this;return void 0===t&&(t=this.moveDuration),0===e.length?Promise.resolve():Promise.all(e.map(function(e){return o.moveTileAnimated(e.from,e.to,t)})).then(function(){o.refreshRenderOrder()})},t.prototype.swapTilesAnimated=function(e,t,o){var r=this;void 0===o&&(o=this.moveDuration);var i=this.tileViews[e.r][e.c],n=this.tileViews[t.r][t.c];if(!i||!n)return Promise.resolve();var s=i.view,c=n.view;i.view=c,n.view=s,this.bindClick(i.view,e),this.bindClick(n.view,t);var l=this.getCellLocalPos(e),a=this.getCellLocalPos(t);return new Promise(function(e){var t=i.view.node,r=n.view.node;t.stopAllActions(),r.stopAllActions(),t.active=!0,r.active=!0;var s=cc.moveTo(o,l),c=cc.moveTo(o,a),u=cc.callFunc(function(){return e()});t.runAction(s),r.runAction(cc.sequence(c,u))}).then(function(){r.refreshRenderOrder()})},t.prototype.setPosition=function(e){var t=this.tileViews[e.r][e.c];t&&t.view.node.setPosition(this.getCellLocalPos(e))},t.prototype.getCellLocalPos=function(e){var t,o=this.tileViews[e.r][e.c];if(!o)return cc.v2(0,0);var r=o.pos,i=r.parent.convertToWorldSpaceAR(r.position),n=(null!==(t=o.view.node.parent)&&void 0!==t?t:this.node).convertToNodeSpaceAR(i);return cc.v2(n.x,n.y)},t.prototype.moveTileAnimated=function(e,t,o){var r=this.tileViews[e.r][e.c],i=this.tileViews[t.r][t.c];if(!r||!i)return Promise.resolve();var n=r.view;r.view=i.view,i.view=n,this.bindClick(i.view,t),this.bindClick(r.view,e);var s=i.pos,c=i.view.node,l=s.parent.convertToWorldSpaceAR(s.position),a=c.parent.convertToNodeSpaceAR(l),u=cc.v2(a.x,a.y);return this.setPosition(e),r.view.node.active=!1,new Promise(function(e){c.stopAllActions(),c.active=!0,c.opacity=255,c.scale=1;var t=cc.moveTo(o,u),r=cc.sequence(t,cc.callFunc(function(){return e()}));c.runAction(r)})},t.prototype.requestSyncPositions=function(){var e=this;this.syncScheduled||(this.syncScheduled=!0,this.scheduleOnce(function(){e.syncScheduled=!1,e.syncNow()},0))},t.prototype.syncNow=function(){var e=this.tilesRoot.getComponent(cc.Layout);e&&e.updateLayout(),this.syncAllPositions(),this.refreshRenderOrder()},t.prototype.syncAllPositions=function(){for(var e=0;e<this.tileViews.length;e++)for(var t=0;t<this.tileViews[e].length;t++)this.tileViews[e][t]&&this.setPosition({r:e,c:t})},t.prototype.refreshRenderOrder=function(){var e,t,o=this.tileViews.length;if(o)for(var r=null!==(t=null===(e=this.tileViews[0])||void 0===e?void 0:e.length)&&void 0!==t?t:1,i=0;i<o;i++)for(var n=this.tileViews[i],s=0;s<n.length;s++){var c=n[s];if(c){var l=i*r+s;c.view.node.setSiblingIndex(l)}}},t.prototype.bindClick=function(e,t){var o=this;e.onClick=function(){var e;null===(e=o.onCellClick)||void 0===e||e.call(o,{r:t.r,c:t.c})}},n([a],t.prototype,"spawnFallDuration",void 0),n([a],t.prototype,"spawnFadeDuration",void 0),n([a],t.prototype,"moveDuration",void 0),n([a(cc.Node)],t.prototype,"tilesRoot",void 0),n([a(cc.Node)],t.prototype,"tilesViewRoot",void 0),n([a(cc.Prefab)],t.prototype,"tilePrefab",void 0),n([a(cc.Prefab)],t.prototype,"cellPrefab",void 0),n([l],t)}(cc.Component);o.BoardView=u,cc._RF.pop()},{"./TileView":"TileView"}],BombTile:[function(e,t,o){"use strict";cc._RF.push(t,"484275Eap9HD7zCxcSpniIm","BombTile");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.BombTile=void 0;var n=e("../../utils/Utils"),s=function(e){function t(t,o){var r=e.call(this,t)||this;return r.radius=o,r}return i(t,e),t.prototype.getAffected=function(e,t){for(var o=e.length,r=o>0?e[0].length:0,i=n.clamp(t.r-this.radius,0,o-1),s=n.clamp(t.r+this.radius,0,o-1),c=n.clamp(t.c-this.radius,0,r-1),l=n.clamp(t.c+this.radius,0,r-1),a=[],u=i;u<=s;u++)for(var p=c;p<=l;p++)e[u][p]&&a.push({r:u,c:p});return a},t}(e("./BaseTile").BaseTile);o.BombTile=s,cc._RF.pop()},{"../../utils/Utils":"Utils","./BaseTile":"BaseTile"}],BoosterConfigLoader:[function(e,t,o){"use strict";cc._RF.push(t,"8e8ceRamClO1Ybtw9d/AQwt","BoosterConfigLoader"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterConfigLoader=void 0;var r=function(){function e(){}return e.load=function(e){return new Promise(function(t,o){cc.resources.load(e,cc.JsonAsset,function(e,r){if(e)return o(e);t(r.json)})})},e}();o.BoosterConfigLoader=r,cc._RF.pop()},{}],BoosterConfig:[function(e,t,o){"use strict";cc._RF.push(t,"7de38YFOQxLK6Ylf1S9sUyx","BoosterConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],BoosterController:[function(e,t,o){"use strict";cc._RF.push(t,"bf9f3AQnE9FeplrBZt2Karm","BoosterController");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(i,n){function s(e){try{l(r.next(e))}catch(t){n(t)}}function c(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(e){return function(t){return l([e,t])}}function l(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(c){n=[6,c],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterController=void 0;var n=function(){function e(e,t){this.board=e,this.first=null,this.id=t}return e.prototype.onCellClick=function(e){return r(this,void 0,Promise,function(){var t,o,r;return i(this,function(i){switch(i.label){case 0:return this.first?(t=this.first,this.first=null,t.r===e.r&&t.c===e.c?(this.board.setSelection(t,!1),[2,!1]):(o=this.board.getTileId(t),r=this.board.getTileId(e),null===o||null===r?(this.board.setSelection(t,!1),[2,!1]):o===r?(this.board.setSelection(t,!1),[2,!1]):(this.board.setSelection(t,!1),[4,this.board.swapTiles(t,e)]))):(this.first={r:e.r,c:e.c},this.board.setSelection(this.first,!0),[2,!1]);case 1:return i.sent(),[2,!0]}})})},e.prototype.reset=function(){this.first&&this.board.setSelection(this.first,!1),this.first=null},e}(),s=function(){function e(e,t,o){this.board=e,this.superTileId=o,this.id=t}return e.prototype.onCellClick=function(e){return r(this,void 0,Promise,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.board.activateSuperAt(e,this.superTileId)];case 1:return t.sent(),[2,!0]}})})},e.prototype.reset=function(){},e}(),c=function(){function e(e,t,o){var r;this.board=e,this.view=t,this.activeId=null,this.charges=new Map,this.config=o,this.boosters=new Map;for(var i=0,n=this.config.boosters;i<n.length;i++){var s=n[i],c=this.createBooster(s);c&&this.boosters.set(s.id,c)}null===(r=this.view)||void 0===r||r.setActive(null)}return e.prototype.initCharges=function(){for(var e,t={},o=0,r=this.config.boosters;o<r.length;o++){var i=r[o];this.charges.set(i.id,i.charges),t[i.id]=i.charges}null===(e=this.view)||void 0===e||e.setCharges(t)},e.prototype.buildChargesMap=function(){var e={};return this.charges.forEach(function(t,o){e[o]=t}),e},e.prototype.setActive=function(e){var t;this.activeId=e,null===e&&this.boosters.forEach(function(e){return e.reset()}),null===(t=this.view)||void 0===t||t.setActive(e)},e.prototype.toggle=function(e){this.activeId===e?this.setActive(null):this.setActive(e)},e.prototype.handleCellClick=function(e){var t,o;return r(this,void 0,Promise,function(){var r,n,s,c;return i(this,function(i){switch(i.label){case 0:return this.board.isBusyOrOver()?[2]:this.activeId?[3,2]:[4,this.board.handleBoardClick(e)];case 1:return i.sent(),[2];case 2:if((r=null!==(t=this.charges.get(this.activeId))&&void 0!==t?t:0)<=0)return this.setActive(null),[2];if(!(n=this.boosters.get(this.activeId)))return[2];s=!1,i.label=3;case 3:return i.trys.push([3,5,,6]),[4,n.onCellClick(e)];case 4:return s=i.sent(),[3,6];case 5:return c=i.sent(),cc.error("Booster error",c),s=!1,[3,6];case 6:return s&&(this.charges.set(this.activeId,r-1),null===(o=this.view)||void 0===o||o.setCharges(this.buildChargesMap()),this.setActive(null)),[2]}})})},e.prototype.createBooster=function(e){switch(e.kind){case"swap":return new n(this.board,e.id);case"super":return new s(this.board,e.id,e.superTileId);default:return null}},e}();o.BoosterController=c,cc._RF.pop()},{}],BoosterView:[function(e,t,o){"use strict";cc._RF.push(t,"0ab77xD8rlMnaAzxO6tZx9Z","BoosterView");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterView=void 0;var s=cc._decorator,c=s.ccclass,l=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boosterButtons=[],t.boosterCounts=[],t.boosterIds=[],t.onToggle=null,t}return i(t,e),t.prototype.onEnable=function(){for(var e=0;e<this.boosterButtons.length;e++){var t=this.boosterButtons[e];t&&t.on(cc.Node.EventType.TOUCH_END,this.handleClick,this)}},t.prototype.onDisable=function(){for(var e=0;e<this.boosterButtons.length;e++){var t=this.boosterButtons[e];t&&t.off(cc.Node.EventType.TOUCH_END,this.handleClick,this)}},t.prototype.handleClick=function(e){var t=e.target,o=this.boosterButtons.indexOf(t);o<0||this.toggleByIndex(o)},t.prototype.toggleByIndex=function(e){var t,o=this.boosterIds[e];o&&(null===(t=this.onToggle)||void 0===t||t.call(this,o))},t.prototype.setCharges=function(e){for(var t=0;t<this.boosterIds.length;t++){var o=this.boosterIds[t],r=this.boosterCounts[t];if(r){var i=e[o];"number"==typeof i&&(r.string=""+i)}}},t.prototype.setActive=function(e){for(var t=0;t<this.boosterIds.length;t++){var o=this.boosterButtons[t];o&&(o.opacity=this.boosterIds[t]===e?255:160)}},n([l([cc.Node])],t.prototype,"boosterButtons",void 0),n([l([cc.Label])],t.prototype,"boosterCounts",void 0),n([l([cc.String])],t.prototype,"boosterIds",void 0),n([c],t)}(cc.Component);o.BoosterView=a,cc._RF.pop()},{}],CellPos:[function(e,t,o){"use strict";cc._RF.push(t,"04cf3txUT5LzJ9SxcuY1Uet","CellPos"),Object.defineProperty(o,"__esModule",{value:!0}),o.UniqueCellPosSet=void 0;var r=function(){function e(e){this.cols=e,this.map=new Map}return e.prototype.key=function(e){return e.r*this.cols+e.c},e.prototype.add=function(e){this.map.set(this.key(e),{r:e.r,c:e.c})},e.prototype.has=function(e){return this.map.has(this.key(e))},e.prototype.delete=function(e){return this.map.delete(this.key(e))},e.prototype.clear=function(){this.map.clear()},Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!1,configurable:!0}),e.prototype.toArray=function(){return Array.from(this.map.values())},e.prototype.values=function(){return this.map.values()},e}();o.UniqueCellPosSet=r,cc._RF.pop()},{}],FitGameWindow:[function(e,t,o){"use strict";cc._RF.push(t,"44072zu8BBJPIoa6dNjUo/y","FitGameWindow");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,l=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.designWidth=1080,t.designHeight=1920,t}return i(t,e),t.prototype.onEnable=function(){this.applyScale(),cc.view.on("canvas-resize",this.applyScale,this)},t.prototype.onDisable=function(){cc.view.off("canvas-resize",this.applyScale,this)},t.prototype.applyScale=function(){var e=cc.view.getVisibleSize(),t=Math.min(e.width/this.designWidth,e.height/this.designHeight);this.node.scale=t},n([l],t.prototype,"designWidth",void 0),n([l],t.prototype,"designHeight",void 0),n([c],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],GameInstaller:[function(e,t,o){"use strict";cc._RF.push(t,"72e2eQ/0/xNb7ocQDCj5Qmw","GameInstaller");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(i,n){function s(e){try{l(r.next(e))}catch(t){n(t)}}function c(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}l((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(e){return function(t){return l([e,t])}}function l(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(c){n=[6,c],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameInstaller=void 0;var l=e("./configs/SuperRulesLoader"),a=e("./configs/BoosterConfigLoader"),u=e("./configs/TileCatalogLoader"),p=e("./controllers/BoardController"),h=e("./controllers/SuperTileRules"),f=e("./controllers/TileFactory"),d=e("./views/BoardView"),v=e("./views/HudView"),y=e("./controllers/ProgressController"),w=e("./controllers/BoosterController"),b=e("./views/BoosterView"),g=cc._decorator,_=g.ccclass,T=g.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boardView=null,t.hudView=null,t.boosterView=null,t.startMoves=30,t.targetScore=500,t.rows=8,t.cols=8,t.catalogPath="configs/tile_catalog",t.superRulesPath="configs/super_rules",t.boostersPath="configs/boosters",t}return i(t,e),t.prototype.start=function(){var e,t,o;return s(this,void 0,Promise,function(){var r,i,n,s,d,v,b,g,_,T,m,R,C,P,B;return c(this,function(c){switch(c.label){case 0:return[4,u.TileCatalogLoader.loadRegistry(this.catalogPath)];case 1:return r=c.sent(),[4,l.SuperRulesLoader.load(this.superRulesPath)];case 2:i=c.sent(),n=r.getSpawnTiles(),s=new h.SuperTileRules(i),d=new Map,v=0,b=r.getAllTile(),c.label=3;case 3:return v<b.length?(g=b[v],_=r.getTileConfigById(g),[4,this.loadSpriteFrame(_.sprite)]):[3,6];case 4:T=c.sent(),d.set(g,T),c.label=5;case 5:return v++,[3,3];case 6:return[4,a.BoosterConfigLoader.load(this.boostersPath)];case 7:return m=c.sent(),R=new f.TileFactory(r),C=new y.ProgressController(null!==(e=this.hudView)&&void 0!==e?e:void 0),this.hudView&&(this.hudView.onRestart=function(){var e=cc.director.getScene();e&&cc.director.loadScene(e.name)}),(P=new p.BoardController(this.rows,this.cols,n,R,s,this.boardView,d,this.startMoves,this.targetScore,C)).start(),(B=new w.BoosterController(P,null!==(t=this.boosterView)&&void 0!==t?t:void 0,m)).initCharges(),this.boosterView&&(this.boosterView.onToggle=function(e){return B.toggle(e)}),this.boardView.onCellClick=function(e){B.handleCellClick(e)},null===(o=this.hudView)||void 0===o||o.playStartFade(),[2]}})})},t.prototype.loadSpriteFrame=function(e){return new Promise(function(t,o){cc.resources.load(e,cc.SpriteFrame,function(e,r){if(e)return o(e);t(r)})})},n([T(d.BoardView)],t.prototype,"boardView",void 0),n([T(v.HudView)],t.prototype,"hudView",void 0),n([T(b.BoosterView)],t.prototype,"boosterView",void 0),n([T],t.prototype,"startMoves",void 0),n([T],t.prototype,"targetScore",void 0),n([T],t.prototype,"rows",void 0),n([T],t.prototype,"cols",void 0),n([T],t.prototype,"catalogPath",void 0),n([T],t.prototype,"superRulesPath",void 0),n([T],t.prototype,"boostersPath",void 0),n([_],t)}(cc.Component);o.GameInstaller=m,cc._RF.pop()},{"./configs/BoosterConfigLoader":"BoosterConfigLoader","./configs/SuperRulesLoader":"SuperRulesLoader","./configs/TileCatalogLoader":"TileCatalogLoader","./controllers/BoardController":"BoardController","./controllers/BoosterController":"BoosterController","./controllers/ProgressController":"ProgressController","./controllers/SuperTileRules":"SuperTileRules","./controllers/TileFactory":"TileFactory","./views/BoardView":"BoardView","./views/BoosterView":"BoosterView","./views/HudView":"HudView"}],HudView:[function(e,t,o){"use strict";cc._RF.push(t,"d562eup/G9BIItUorBzSqN9","HudView");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.HudView=void 0;var s=cc._decorator,c=s.ccclass,l=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.movesLabel=null,t.resultLabel=null,t.resultOverlay=null,t.restartButton=null,t.startFadeOverlay=null,t.fadeDuration=.4,t.fadeDelay=.05,t.onRestart=null,t}return i(t,e),t.prototype.onEnable=function(){this.restartButton&&this.restartButton.node.on(cc.Node.EventType.TOUCH_END,this.restart,this)},t.prototype.onDisable=function(){this.restartButton&&this.restartButton.node.off(cc.Node.EventType.TOUCH_END,this.restart,this)},t.prototype.setScore=function(e,t){this.scoreLabel&&(this.scoreLabel.string=e+"/"+t)},t.prototype.setMoves=function(e){this.movesLabel&&(this.movesLabel.string=""+e)},t.prototype.showResult=function(e){this.resultLabel&&(this.resultLabel.string=e),this.resultLabel&&(this.resultLabel.node.active=!0),this.resultOverlay&&(this.resultOverlay.active=!0)},t.prototype.hideResult=function(){this.resultLabel&&(this.resultLabel.node.active=!1),this.resultOverlay&&(this.resultOverlay.active=!1)},t.prototype.playStartFade=function(){if(this.startFadeOverlay){var e=this.startFadeOverlay;e.stopAllActions(),e.active=!0,e.opacity=255,cc.tween(e).delay(this.fadeDelay).to(this.fadeDuration,{opacity:0}).call(function(){e.active=!1}).start()}},t.prototype.restart=function(){var e;null===(e=this.onRestart)||void 0===e||e.call(this)},n([l(cc.Label)],t.prototype,"scoreLabel",void 0),n([l(cc.Label)],t.prototype,"movesLabel",void 0),n([l(cc.Label)],t.prototype,"resultLabel",void 0),n([l(cc.Node)],t.prototype,"resultOverlay",void 0),n([l(cc.Button)],t.prototype,"restartButton",void 0),n([l(cc.Node)],t.prototype,"startFadeOverlay",void 0),n([l],t.prototype,"fadeDuration",void 0),n([l],t.prototype,"fadeDelay",void 0),n([c],t)}(cc.Component);o.HudView=a,cc._RF.pop()},{}],NormalTile:[function(e,t,o){"use strict";cc._RF.push(t,"4160f0xaJ9NNL7Xwb5jlFtN","NormalTile");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.NormalTile=void 0;var n=e("./BaseTile"),s=e("./CellPos"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getAffected=function(e,t){return this.uniqCell=new s.UniqueCellPosSet(e[0].length),this.getNeighbours(e,t)},t.prototype.getNeighbours=function(e,t){var o=[];return this.uniqCell.add(t),o.push(t),t.r-1>=0&&!this.uniqCell.has({r:t.r-1,c:t.c})&&e[t.r][t.c].id===e[t.r-1][t.c].id&&o.push.apply(o,this.getNeighbours(e,{r:t.r-1,c:t.c})),t.r+1<e.length&&!this.uniqCell.has({r:t.r+1,c:t.c})&&e[t.r][t.c].id===e[t.r+1][t.c].id&&o.push.apply(o,this.getNeighbours(e,{r:t.r+1,c:t.c})),t.c-1>=0&&!this.uniqCell.has({r:t.r,c:t.c-1})&&e[t.r][t.c].id===e[t.r][t.c-1].id&&o.push.apply(o,this.getNeighbours(e,{r:t.r,c:t.c-1})),t.c+1<e[t.r].length&&!this.uniqCell.has({r:t.r,c:t.c+1})&&e[t.r][t.c].id===e[t.r][t.c+1].id&&o.push.apply(o,this.getNeighbours(e,{r:t.r,c:t.c+1})),o},t}(n.BaseTile);o.NormalTile=c,cc._RF.pop()},{"./BaseTile":"BaseTile","./CellPos":"CellPos"}],ProgressController:[function(e,t,o){"use strict";cc._RF.push(t,"9d63aYvTtNIXLJ1xNEsPCzb","ProgressController"),Object.defineProperty(o,"__esModule",{value:!0}),o.ProgressController=void 0;var r=function(){function e(e){this.movesLeft=0,this.score=0,this.target=0,this.hud=null,this.hud=null!=e?e:null}return e.prototype.setHud=function(e){this.hud=null!=e?e:null},e.prototype.init=function(e,t){var o,r,i;this.movesLeft=Math.max(0,e),this.score=0,this.target=Math.max(0,t),null===(o=this.hud)||void 0===o||o.hideResult(),null===(r=this.hud)||void 0===r||r.setMoves(this.movesLeft),null===(i=this.hud)||void 0===i||i.setScore(this.score,this.target)},e.prototype.canSpendMove=function(){return this.movesLeft>0},e.prototype.spendMove=function(){var e;this.movesLeft<=0||(this.movesLeft-=1,null===(e=this.hud)||void 0===e||e.setMoves(this.movesLeft))},e.prototype.addScore=function(e){var t;e<=0||(this.score+=e,null===(t=this.hud)||void 0===t||t.setScore(this.score,this.target))},e.prototype.getMoves=function(){return this.movesLeft},e.prototype.isWin=function(){return this.score>=this.target},e.prototype.showResult=function(e){var t;null===(t=this.hud)||void 0===t||t.showResult(e)},e}();o.ProgressController=r,cc._RF.pop()},{}],RocketColTile:[function(e,t,o){"use strict";cc._RF.push(t,"61ad2S/Y7hMQLBRKI9q0+w0","RocketColTile");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.RocketColTile=void 0;var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getAffected=function(e,t){for(var o=t.c,r=[],i=0;i<e.length;i++)e[i][o]&&r.push({r:i,c:o});return r},t}(e("./BaseTile").BaseTile);o.RocketColTile=n,cc._RF.pop()},{"./BaseTile":"BaseTile"}],RocketRowTile:[function(e,t,o){"use strict";cc._RF.push(t,"4321cejqLNKqreUaGYRRg2D","RocketRowTile");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.RocketRowTile=void 0;var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getAffected=function(e,t){for(var o=t.r,r=[],i=0;i<e[o].length;i++)e[o][i]&&r.push({r:o,c:i});return r},t}(e("./BaseTile").BaseTile);o.RocketRowTile=n,cc._RF.pop()},{"./BaseTile":"BaseTile"}],SuperRulesLoader:[function(e,t,o){"use strict";cc._RF.push(t,"509c1cCc/dD9pTySmkDFgEg","SuperRulesLoader"),Object.defineProperty(o,"__esModule",{value:!0}),o.SuperRulesLoader=void 0;var r=function(){function e(){}return e.load=function(e){return new Promise(function(t,o){cc.resources.load(e,cc.JsonAsset,function(e,r){if(e)return o(e);t(r.json)})})},e}();o.SuperRulesLoader=r,cc._RF.pop()},{}],SuperTileRules:[function(e,t,o){"use strict";cc._RF.push(t,"f4aacxl5RRJs7KgFr8V0ZRN","SuperTileRules"),Object.defineProperty(o,"__esModule",{value:!0}),o.SuperTileRules=void 0;var r=function(){function e(e){this.minGroupToDestroy=e.minGroupToDestroy,this.rules=e.rules.slice().sort(function(e,t){return t.minGroup-e.minGroup})}return e.prototype.pickSpawnId=function(e){for(var t=0,o=this.rules;t<o.length;t++){var r=o[t];if(e>=r.minGroup){var i=r.spawnIds;return i[Math.floor(Math.random()*i.length)]}}return null},e}();o.SuperTileRules=r,cc._RF.pop()},{}],TileCatalogLoader:[function(e,t,o){"use strict";cc._RF.push(t,"afabcdmH25AKpkbKBC5/sTj","TileCatalogLoader"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileCatalogLoader=void 0;var r=e("./TileRegistry"),i=function(){function e(){}return e.loadRegistry=function(e){return new Promise(function(t,o){cc.resources.load(e,cc.JsonAsset,function(e,i){if(e)return o(e);var n=i.json;t(new r.TileRegistry(n.tiles))})})},e}();o.TileCatalogLoader=i,cc._RF.pop()},{"./TileRegistry":"TileRegistry"}],TileConfig:[function(e,t,o){"use strict";cc._RF.push(t,"3df7aDWY+FOqookT8NeJMW9","TileConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TileFactory:[function(e,t,o){"use strict";cc._RF.push(t,"7ad21YgIfVO+7SUNYs8jZHa","TileFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileFactory=void 0;var r=e("../models/BombTile"),i=e("../models/NormalTile"),n=e("../models/RocketColTile"),s=e("../models/RocketRowTile"),c=function(){function e(e){this.registry=e}return e.prototype.createTile=function(e){var t=this.registry.getTileConfigById(e);switch(t.kind){case"normal":return new i.NormalTile(t.id);case"bomb":return new r.BombTile(t.id,t.radius);case"rocketRow":return new s.RocketRowTile(t.id);case"rocketCol":return new n.RocketColTile(t.id)}},e}();o.TileFactory=c,cc._RF.pop()},{"../models/BombTile":"BombTile","../models/NormalTile":"NormalTile","../models/RocketColTile":"RocketColTile","../models/RocketRowTile":"RocketRowTile"}],TileRegistry:[function(e,t,o){"use strict";cc._RF.push(t,"4ede869jQNMFJ8QPkc0AViQ","TileRegistry"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileRegistry=void 0;var r=function(){function e(e){this.byId=new Map;for(var t=0,o=e;t<o.length;t++){var r=o[t];this.byId.set(r.id,r)}}return e.prototype.getTileConfigById=function(e){var t=this.byId.get(e);if(!t)throw new Error("No Tile for id="+e);return t},e.prototype.getSpawnTiles=function(){var e=[];if(this.byId.forEach(function(t){"normal"===t.kind&&e.push(t.id)}),0===e.length)throw new Error("No normal tiles to spawn (tile_catalog.json)");return e},e.prototype.getAllTile=function(){return Array.from(this.byId.keys())},e}();o.TileRegistry=r,cc._RF.pop()},{}],TileView:[function(e,t,o){"use strict";cc._RF.push(t,"3d2cfUyzjFIZazG83C0IVpO","TileView");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileView=void 0;var s=cc._decorator,c=s.ccclass,l=s.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=null,t.sprite=null,t}return i(t,e),t.prototype.setFrame=function(e){this.sprite.spriteFrame=e,this.node.active=!0},t.prototype.Hide=function(){this.node.active=!1},t.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.handleClick,this)},t.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.handleClick,this)},t.prototype.handleClick=function(){var e;null===(e=this.onClick)||void 0===e||e.call(this)},t.prototype.playSpawn=function(e){var t=this;this.node.stopAllActions(),this.node.active=!0,this.node.scale=0;var o=cc.scaleTo(.5,1).easing(cc.easeBackIn()),r=cc.fadeTo(.5,255),i=cc.spawn(o,r),n=cc.sequence(i,cc.callFunc(function(){t.node.active=!0,t.node.opacity=255,null==e||e()}));this.node.runAction(n)},t.prototype.playHide=function(e){var t=this;this.node.stopAllActions();var o=cc.scaleTo(.5,.1).easing(cc.easeBackIn()),r=cc.fadeTo(.5,0),i=cc.spawn(o,r),n=cc.sequence(i,cc.callFunc(function(){t.node.active=!1,t.node.opacity=255,t.node.scale=1,null==e||e()}));this.node.runAction(n)},n([l(cc.Sprite)],t.prototype,"sprite",void 0),n([c],t)}(cc.Component);o.TileView=a,cc._RF.pop()},{}],Utils:[function(e,t,o){"use strict";cc._RF.push(t,"c6019UVaHBBrYjLqHJQIgz1","Utils"),Object.defineProperty(o,"__esModule",{value:!0}),o.clamp=o.delay=void 0,o.delay=function(e){return new Promise(function(t){return setTimeout(t,e)})},o.clamp=function(e,t,o){return Math.max(t,Math.min(o,e))},cc._RF.pop()},{}]},{},["GameInstaller","BoosterConfig","BoosterConfigLoader","SuperRulesLoader","TileCatalogLoader","TileConfig","TileRegistry","BoardController","BoosterController","ProgressController","SuperTileRules","TileFactory","BaseTile","BoardModel","BombTile","CellPos","NormalTile","RocketColTile","RocketRowTile","BoardView","BoosterView","FitGameWindow","HudView","TileView","Utils"]);